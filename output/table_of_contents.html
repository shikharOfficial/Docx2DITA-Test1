<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generated HTML</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous"></head><body><div id="navbar"><div id="logo-bar"><span onclick="openMenu()" id="menuToggle">‚ò∞</span></div><div id="searchBar"><input id="text-to-search" type="text" placeholder="Type something..." oninput="search()"><button id="search-button" onclick="search()">üîç</button><button id="clear-button" onclick="clearSearch()">X</button></div></div><div class="container"><div class="row"><html lang="en-us"><head><meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2024"><meta name="DC.rights.owner" content="(C) Copyright 2024"><meta name="DC.type" content="concept"><meta name="DC.relation" scheme="URI" content="structural_elements.html"><meta name="DC.format" content="HTML5"><meta name="DC.identifier" content="V5136580"><meta name="DC.language" content="en-us"><link rel="stylesheet" type="text/css" href="commonltr.css"><title>Table of Contents</title></head><body id="V5136580"><nav role="toc"><ul><li><a href="demonstration_of_docx_support_in_calibre.html">Demonstration of DOCX support in calibre</a></li><li><a href="text_formatting.html">Text Formatting</a><ul><li><a href="inline_formatting.html">Inline formatting</a></li><li><a href="fun_with_fonts.html">Fun with fonts</a></li><li><a href="paragraph_level_formatting.html">Paragraph level formatting</a></li></ul></li><li><a href="tables.html">tables.dita</a></li><li><a href="structural_elements.html">Structural Elements</a><ul><li><a href="footnotes_amp_endnotes.html">Footnotes &amp; Endnotes</a></li><li><a href="dropcaps.html">Dropcaps</a></li><li><a href="links.html">Links</a></li><li class="active"><a href="table_of_contents.html">Table of Contents</a></li></ul></li><li><a href="images.html">Images</a></li><li><a href="lists.html">Lists</a><ul><li><a href="bulleted_list.html">Bulleted List</a></li><li><a href="numbered_list.html">Numbered List</a></li><li><a href="multilevel_lists.html">Multi-level Lists</a></li><li><a href="continued_lists.html">Continued Lists</a></li></ul></li></ul></nav><main role="main"><article role="article" aria-labelledby="V5136580___Toc359077861"><h1 class="title topictitle1" id="V5136580___Toc359077861">Table of Contents</h1><div class="body conbody"><p class="p">There are two approaches that calibre takes when generating a Table of Contents. The first is if the Word document has a Table of Contents itself. Provided that the Table of Contents uses hyperlinks, calibre will automatically use it. The levels of the Table of Contents are identified by their left indent, so if you want the ebook to have a multi-level Table of Contents, make sure you create a properly indented Table of Contents in Word.</p><p class="p">If no Table of Contents is found in the document, then a table of contents is automatically generated from the headings in the document. A heading is identified as something that has the Heading 1 or Heading 2, etc. style applied to it. These headings are turned into a Table of Contents with Heading 1 being the topmost level, Heading 2 the second level and so on.</p><p class="p"> You can see the Table of Contents created by calibre by clicking the Table of Contents button in whatever viewer you are using to view the converted ebook. </p><p class="p"><a class="xref" href="demonstration_of_docx_support_in_calibre.html#m5785094___Toc359077851">Demonstration of DOCX support in calibre	1</a></p><p class="p"><a class="xref" href="text_formatting.html#z0213361___Toc359077852">Text Formatting	2</a></p><p class="p"><a class="xref" href="inline_formatting.html#W8702615___Toc359077853">Inline formatting	2</a></p><p class="p"><a class="xref" href="fun_with_fonts.html#g9879159___Toc359077854">Fun with fonts	2</a></p><p class="p"><a class="xref" href="paragraph_level_formatting.html#g8130954___Toc359077855">Paragraph level formatting	2</a></p><p class="p"><a class="xref" href="tables.html#S9580335___Toc359077856">Tables	3</a></p><p class="p"><a class="xref" href="#_Toc359077857">Structural Elements	5</a></p><p class="p"><a class="xref" href="footnotes_amp_endnotes.html#l9879249___Toc359077858">Footnotes &amp; Endnotes	5</a></p><p class="p"><a class="xref" href="dropcaps.html#u8353011___Toc359077859">Dropcaps	5</a></p><p class="p"><a class="xref" href="links.html#h2377652___Toc359077860">Links	5</a></p><p class="p"><a class="xref" href="table_of_contents.html#V5136580___Toc359077861">Table of Contents	5</a></p><p class="p"><a class="xref" href="images.html#w0073170___Toc359077862">Images	7</a></p><p class="p"><a class="xref" href="lists.html#U9238941___Toc359077863">Lists	8</a></p><p class="p"><a class="xref" href="bulleted_list.html#x5541688___Toc359077864">Bulleted List	8</a></p><p class="p"><a class="xref" href="numbered_list.html#q0025655___Toc359077865">Numbered List	8</a></p><p class="p"><a class="xref" href="multilevel_lists.html#Q2516739___Toc359077866">Multi-level Lists	8</a></p><p class="p"><a class="xref" href="continued_lists.html#K0060873___Toc359077867">Continued Lists	8</a></p></div><nav role="navigation" class="related-links"><div class="familylinks"><div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="structural_elements.html">Structural Elements</a></div></div></nav></article></main></body></html><div class="on-this-page"><b>On this page</b><br><br></div></div></div><div class="to-top" onclick="scrollToTop()"><i class="fa-solid fa-arrow-up"></i></div><div class="footer"><div class="bottom"></div><span class="ftrtxt"></span></div></body></html><script src="https://kit.fontawesome.com/a1435abe6f.js" crossorigin="anonymous"></script><script>
  
      const expandmenu = document.querySelectorAll(
        '.container nav[role="toc"] li, .container nav.toc li'
      );
      const multiChapetersTopic = []
      expandmenu.forEach((ele) => {
        if (checkForChildUnorderedList(ele.childNodes)) multiChapetersTopic.push(ele);
      });
      function checkForChildUnorderedList(nodes) {
        for (const childNode of nodes) {
          if (childNode.nodeName === "UL") return true;
        }
      }
      addCollapsibleMenu(multiChapetersTopic);
      function handleCollapse(){
        event.target.classList.toggle("rotate-dropdown-arrow")
        event.target.nextElementSibling.nextElementSibling.classList.toggle("show-submenu")
      }
      function openMenu(){
        const menu = document.querySelector('.container>.row')
        menu.classList.toggle("hide-menu")
      }
      function addCollapsibleMenu(allTopics){
        allTopics.forEach((topic) => {
          topic.childNodes[1].classList.add("hide-submenu");
          const collapseButton = document.createElement("div");
          collapseButton.classList.add("dropdown-arrow")
          collapseButton.addEventListener("click", handleCollapse);
          topic.insertBefore(collapseButton, topic.firstChild);
        });
      }
      function trackActiveTopic(){
        // logic to handle breadcrumb
        const breadCrumbDiv = document.createElement("div");
        breadCrumbDiv.classList.add("breadcrumb")
        const contentArea = document.querySelector('main.main, main[role="main"]')
        contentArea.insertBefore(breadCrumbDiv,contentArea.firstChild)
        // ends here
        const activeTopic = document.querySelector('.container nav[role="toc"] .active,.container nav.toc .active')
        keepActiveCollapsableMenuOpen(activeTopic)
      }
      function keepActiveCollapsableMenuOpen(activeTopic){
        handleBreadCrumbs(activeTopic)
        if(activeTopic.nodeName === "NAV") return 
        if(activeTopic.parentElement.classList.contains("hide-submenu")){
          activeTopic.parentElement.classList.toggle("show-submenu")
          activeTopic.parentElement?.previousElementSibling?.previousElementSibling?.classList.toggle("rotate-dropdown-arrow")
        }
        keepActiveCollapsableMenuOpen(activeTopic.parentElement)
      }
      trackActiveTopic()
      function handleBreadCrumbs(activeTopic){
        if(activeTopic.nodeName !== "LI") return
        const breadCrumbDiv = document.querySelector('main.main .breadcrumb, main[role="main"] .breadcrumb')
        const newLink = document.createElement("a")
        newLink.innerHTML = activeTopic.childNodes[1]?activeTopic.childNodes[1].innerText : activeTopic.innerText 
        newLink.setAttribute("href",activeTopic.childNodes[1]?activeTopic.childNodes[1].href : activeTopic.childNodes[0].href)
        breadCrumbDiv.insertBefore(newLink,breadCrumbDiv.firstChild)
      }
      window.addEventListener("scroll",()=>{
        const toTop = document.querySelector(".to-top")
        if(window.pageYOffset > 100){
          toTop.classList.add("to-top-visible")
        }else{
          toTop.classList.remove("to-top-visible")
        }
      })
      function scrollToTop(){
        window.scrollTo(0,0)
      }
      function addLogo(){
        const logoDiv = document.querySelector("#logo-bar")
        const logoImg = document.createElement("img")
        logoDiv.append(logoImg)
      }
      addLogo()
      function addNextAndPreviousButtons() {
        const contentBody = document.querySelector(
          'main.main,main[role="main"]'
        );
        const nextButton = document.createElement("a");
        const prevButton = document.createElement("a");
        nextButton.innerHTML =
          'Next Topic <i class="fa-solid fa-arrow-right"></i>';
        prevButton.innerHTML =
          '<i class="fa-solid fa-arrow-left"></i> Previous Topic';
        const nextPrevContainer = document.createElement("div");
        nextPrevContainer.classList.add("next-prev-container");
        nextPrevContainer.append(prevButton);
        nextPrevContainer.append(nextButton);
        const activeTopic = document.querySelector("li.active")
        console.dir(activeTopic)
        const {nextTopic,prevTopic} = getTopicNameAndLink(activeTopic.previousElementSibling,activeTopic.nextElementSibling)
        nextButton.href = nextTopic?.href || "javascript:void(0)"
        nextButton.setAttribute("tooltip",nextTopic?.innerText || "")
        prevButton.href = prevTopic?.href || "javascript:void(0)"
        prevButton.setAttribute("tooltip",prevTopic?.innerText || "")
        contentBody.append(nextPrevContainer);
      }
      function getTopicNameAndLink(previousElementSibling,nextElementSibling){
        let prevTopic = null,nextTopic=null;
        if(previousElementSibling){
          for(const childElement of previousElementSibling.childNodes){
            if(childElement.nodeName === "A"){
              prevTopic=childElement
            }
          }
        }
        if(nextElementSibling){
          for(const childElement of nextElementSibling.childNodes){
            if(childElement.nodeName === "A"){
              nextTopic=childElement
            }
          }
        }
        return {
          nextTopic,
          prevTopic
        }
      }
      addNextAndPreviousButtons();
      let searchResultsDisplayed = false;
      toggleButtonsVisibility()
      let originalContent = '';
      function addClassToAllTags() {
        const body = document.querySelector('body');
        const allElements = body.getElementsByTagName('*');
        for (const element of allElements) {
          if (element.id === 'navbar' || element.nodeName === 'IMG') {
            continue;
          }
          element.classList.add('paragraph');
        }
        originalContent = document.querySelector('main').innerHTML; 
      }
      window.addEventListener('DOMContentLoaded', addClassToAllTags);
      function search() {
        let textToSearch = document.getElementById('text-to-search').value;
        if (!textToSearch || 3 > textToSearch.length) {
          restoreOriginalContent()
          return;
        }
        let mainContent = document.querySelector('main');
        textToSearch = textToSearch.replace(/[.*+?^()|[]\]/g, "\$");
        let pattern = new RegExp(textToSearch, "gi");
        mainContent.innerHTML = originalContent; 
        let paragraphs = mainContent.querySelectorAll('.paragraph:not([role="toc"])');
        for (const element of paragraphs) {
          if (element.querySelector('img,a')) {
            continue; // Skip the entire paragraph if an image is present
          }
          element.innerHTML = element.innerHTML.replace(pattern, match => '<mark>'+match+'</mark>');
        }
        searchResultsDisplayed = true;
        toggleButtonsVisibility();
      }
      function restoreOriginalContent() {
        let mainContent = document.querySelector('main');
        mainContent.innerHTML = originalContent; // Restore original content
        searchResultsDisplayed = false;
        toggleButtonsVisibility();
      }
      function toggleButtonsVisibility() {
        const searchButton = document.getElementById('search-button');
        const clearButton = document.getElementById('clear-button');
        if (searchResultsDisplayed) {
          searchButton.style.display = 'none';
          clearButton.style.display = 'inline-block';
        } else {
          searchButton.style.display = 'inline-block';
          clearButton.style.display = 'none';
        }
      }
      function clearSearch() {
        let mainContent = document.querySelector('main');
        let paragraphs = mainContent.querySelectorAll('.paragraph:not([role="toc"])');
        for (const element of paragraphs) {
          element.innerHTML = element.innerHTML.replace(/<mark>/g, "").replace(/<\/mark>/g, "");
        }
        document.getElementById('text-to-search').value = '';
        searchResultsDisplayed = false;
        toggleButtonsVisibility();
      }
      // on this page logic
        function handleOnthisPage(){
          const onThisPageContainer = document.querySelector('div.on-this-page')
          const mainContent = document.querySelector('main[role="main"],main.main')
          const allHeadings = mainContent.querySelectorAll('h1, h2, h3');
          let currentTopic = null;
          let currentTopicList = null;
          allHeadings.forEach((heading) => {
            const headingText = heading.innerText;
            let headingId = heading.getAttribute('id');
            if (heading.tagName === 'H1') {
              // Create a new main topic
              if (currentTopicList) {
                currentTopic.appendChild(currentTopicList);
              }
              currentTopic = document.createElement('div');
              currentTopicList = document.createElement('ul');
              const topicTitle = document.createElement('a');
              topicTitle.innerHTML = '<strong>'+headingText+'</strong>';
              topicTitle.href = '#'+headingId
              topicTitle.classList.add('main-topic');
              currentTopic.appendChild(topicTitle);
              currentTopic.appendChild(currentTopicList);
              onThisPageContainer.appendChild(currentTopic);
            } else if (heading.tagName === 'H2' || heading.tagName === "H3" && currentTopicList) {
              // Create a subtopic
              const subtopicListItem = document.createElement('li');
              const subtopicLink = document.createElement('a');
              if(!headingId){
                headingId = generateRandomId()
              }
              heading.setAttribute('id',headingId)
              subtopicLink.textContent = headingText;
              subtopicLink.href = '#' + headingId;
              subtopicListItem.appendChild(subtopicLink);
              currentTopicList.appendChild(subtopicListItem);
            }
          });
        }
        handleOnthisPage()
        //logic to prevent hiding section by navbar while navigating through on this page section
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
          anchor.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href').substring(1);
            const targetElement = document.getElementById(targetId);
            if (targetElement) {
              const offset = targetElement.getBoundingClientRect().top + window.scrollY - 100 //navbarHeight;
              window.scrollTo({
                top: offset,
                behavior: 'smooth'
              });
            }
          });
        });
        function adjustTables(){
          const allRows = document.querySelectorAll('tr.row');
          for(const row of allRows){
            row.classList.remove('row')
          }
        }
        adjustTables()
        function generateRandomId() {
          const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
          const idLength = 8;
          let randomId = '';
          for (let i = 0; i < idLength; i++) {
            const randomIndex = Math.floor(Math.random() * characters.length);
            randomId += characters.charAt(randomIndex);
          }
          return randomId;
        }
        //function to handle broken image link in logo
        function handleBrokenLogo() {
          const logoImg = document.querySelector('#logo-bar img');
          logoImg.addEventListener('error',()=>{
            logoImg.style.display = 'none'
          })
        }
        handleBrokenLogo()
      
  </script>